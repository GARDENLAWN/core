; --- Extensions ---
; Magento wymaga Imagick do poprawnego przetwarzania obrazów
extension=imagick.so

; --- Xdebug (Development) ---
; Konfiguracja debugera dla środowiska WSL/Dev
[xdebug]
zend_extension=xdebug
xdebug.mode=debug
xdebug.client_host=127.0.0.1
xdebug.client_port=9003
xdebug.start_with_request=yes

[PHP]
; --- Resource Limits ---
; Zmieniono z 8G na 3G (bezpieczne dla serwera 8GB RAM: 2GB OS + 2GB OpenSearch + 1GB MySQL + 3GB PHP)
memory_limit = 3G
; Wydłużony czas wykonywania (zapobiega timeoutom przy setup:upgrade)
max_execution_time = 1800
; Czas na przetworzenie danych wejściowych
max_input_time = 60
; Zwiększone limity uploadu (dla dużych paczek i zdjęć)
upload_max_filesize = 64M
post_max_size = 64M
; Kluczowe dla Magento! Zapobiega ucinaniu danych przy zapisie dużych kategorii/menu
max_input_vars = 10000

; --- Performance (Realpath Cache) ---
; Magento ma tysiące plików, domyślne 4M to za mało
realpath_cache_size = 10M
realpath_cache_ttl = 7200

; --- Error Handling ---
; Na produkcji błędy tylko do logów
display_errors = Off
log_errors = On

[Date]
; Ustawienie strefy czasowej
date.timezone = "Europe/Warsaw"

[Session]
; Magento zarządza sesją samodzielnie
session.auto_start = 0
; Czas życia sesji (24 minuty standardowo)
session.gc_maxlifetime = 1440

[opcache]
; --- Opcache Optimization ---
; Włączony Opcache
opcache.enable=1
; Zwiększona pamięć na skompilowane skrypty
opcache.memory_consumption=512
; Bufor dla stringów (ważne w Magento)
opcache.interned_strings_buffer=64
; Ilość plików (Magento ma ich > 50k)
opcache.max_accelerated_files=60000
; Walidacja timestampów (na dev = 1, na prod = 0)
opcache.validate_timestamps=1
opcache.revalidate_freq=0
; Wymagane dla poprawnego działania adnotacji w Magento
opcache.save_comments=1
; Włączenie dla CLI (przyspiesza bin/magento)
opcache.enable_cli=1
